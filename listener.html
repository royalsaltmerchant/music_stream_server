<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Strahd Radio</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <h1>Strahd Radio â€“ Listener</h1>

    <button id="start-button">â–¶ï¸ Start Listening</button><br><br>

    <audio id="radio" preload="none" style="display:none;"></audio><br>

    <!-- <label for="volume">
        <span class="volume-text">ğŸ”‰ Volume:</span>
        <input type="range" id="volume" min="0" max="1" step="0.01" value="0.8">
    </label> -->
    <label for="volume">
        <span class="volume-text">ğŸ”‰ Volume: <span id="volume-display">80%</span></span>
        <input type="range" id="volume" min="0" max="1" step="0.01" value="0.8">
      </label>

    <script>
        const button = document.getElementById("start-button");
        const audio = document.getElementById("radio");
        const volumeSlider = document.getElementById("volume");
        const volumeDisplay = document.getElementById("volume-display");


        button.addEventListener("click", () => {
            console.log("ğŸ§ Start Listening clicked");

            audio.pause();
            audio.src = "";
            audio.load();

            audio.src = "/stream?_=" + Date.now();
            audio.load();
            audio.volume = parseFloat(volumeSlider.value);
            audio.style.display = "inline";
            button.style.display = "none";

            setTimeout(() => {
                audio.play().then(() => {
                    console.log("ğŸ¶ Playback started");
                }).catch(err => {
                    console.error("âŒ Playback error:", err);
                });
            }, 500);
        });

        volumeSlider.addEventListener("input", () => {
            const volValue = parseFloat(volumeSlider.value);
            const volPercent = Math.round(volValue * 100);
            audio.volume = volValue;
            volumeDisplay.textContent = volPercent + '%';
        });
    </script>
</body>
</html>
